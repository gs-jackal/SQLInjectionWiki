<h3 id="executing-os-commands-through-sql-server">Executing OS Commands Through SQL Server</h3>

<p class="pageDescription">{{site.data.injectionDescriptions.executingOSCommands}}</p>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>xp_cmdshell</td>
      <td>-- Enable show advanced options <br>sp_configure 'show advanced options', 1 <br> RECONFIGURE <br> GO <br><br>-- Enable xp_cmdshell <br> sp_configure 'xp_cmdshell', 1 <br> RECONFIGURE <br> GO <br><br> EXEC xp_cmdshell 'net user'</td>
    </tr>
    <tr>
      <td>Write to registry autorun</td>
      <td><a href="https://blog.netspi.com/establishing-registry-persistence-via-sql-server-powerupsql/" target="_blank" rel="noopener">https://blog.netspi.com/establishing-registry-persistence-via-sql-server-powerupsql/</a><br/><a href="https://gist.github.com/nullbind/03af8d671621a6e1cef770bace19a49e"
          target="_blank" rel="noopener">https://gist.github.com/nullbind/03af8d671621a6e1cef770bace19a49e</a></td>
    </tr>
    <tr>
      <td>Write to file autorun</td>
      <td><a href="https://blog.netspi.com/how-to-hack-database-links-in-sql-server/" target="_blank" rel="noopener">https://blog.netspi.com/how-to-hack-database-links-in-sql-server/</a></td>
    </tr>
    <tr>
      <td>Agent Jobs</td>
      <td><a href="https://www.optiv.com/blog/mssql-agent-jobs-for-command-execution" target="_blank" rel="noopener noreferrer">https://www.optiv.com/blog/mssql-agent-jobs-for-command-execution</a></td>
    </tr>
    <tr>
      <td>SQL Injection in stored procedures</td>
      <td><a href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-3-sqli-and-user-impersonation/" target="_blank" rel="noopener">https://blog.netspi.com/hacking-sql-server-stored-procedures-part-3-sqli-and-user-impersonation/</a></td>
    </tr>
    <tr>
      <td>CLR Assembly</td>
      <td><a href="https://blog.netspi.com/attacking-sql-server-clr-assemblies/" target="_blank" rel="noopener">https://blog.netspi.com/attacking-sql-server-clr-assemblies/</a>
      </td>
    </tr>
    <tr>
      <td>Custom Extended Stored Procedure</td>
      <td><a href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/cmd_exec.cpp" target="_blank" rel="noopener">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/cmd_exec.cpp</a></td>
    </tr>
  </tbody>
</table>
<h3>TSQL</h3>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>Name</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ActiveX Javascript Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_jscript.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_jscript.sql</a></td>
    </tr>
    <tr>
      <td>ActiveX VBScript Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_vbscript.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_activex_vbscript.sql</a></td>
    </tr>
    <tr>
      <td>cmdexec Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_cmdexec.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_cmdexec.sql</a></td>
    </tr>
    <tr>
      <td>Powershell Agent Job</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_powershell.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_agentjob_powershell.sql</a></td>
    </tr>
    <tr>
      <td>Custom Command Shell</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_customxp.cpp">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_customxp.cpp</a></td>
    </tr>
    <tr>
      <td>OLE Automation Object</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_oleautomationobject.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_oleautomationobject.sql</a></td>
    </tr>
    <tr>
      <td>OPENROWSET</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_openrowset.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_openrowset.sql</a></td>
    </tr>
    <tr>
      <td>Python</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_pythonscript.tsql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_pythonscript.tsql</a></td>
    </tr>
    <tr>
      <td>R</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_rscript.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_rscript.sql</a></td>
    </tr>
    <tr>
      <td>xp_cmdshell proxy</td>
      <td><a target="_blank" href="https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_xpcmdshell_proxy.sql">https://github.com/NetSPI/PowerUpSQL/blob/master/templates/tsql/oscmdexec_xpcmdshell_proxy.sql</a></td>
    </tr>
  </tbody>
</table>
